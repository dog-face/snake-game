# Render Blueprint for Nova WebGames
# This file defines all services needed for the application
# Note: Render requires a credit card even for free tier (to prevent abuse)
# You won't be charged for free tier usage within limits

services:
  # Backend API Service
  - type: web
    name: nova-webgames-backend
    env: docker
    dockerfilePath: ./nova-webgames-be/Dockerfile.prod
    dockerContext: ./nova-webgames-be
    plan: free  # Free tier - spins down after 15 min inactivity
    region: oregon  # Change to your preferred region
    buildCommand: ""  # Docker handles building
    startCommand: ""  # Defined in Dockerfile
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: snake-game-db  # Using existing database (will rename later if needed)
          property: connectionString
      - key: SECRET_KEY
        generateValue: true  # Render will generate a secure key
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: 1440  # 24 hours
      - key: SESSION_TIMEOUT
        value: 300  # 5 minutes
      - key: CORS_ORIGINS
        value: "https://nova-webgames-frontend.onrender.com"  # Update with your actual frontend URL
    healthCheckPath: /health

  # Frontend Web Service
  - type: web
    name: nova-webgames-frontend
    env: docker
    dockerfilePath: ./nova-webgames-fe/Dockerfile.prod
    dockerContext: ./nova-webgames-fe
    plan: free  # Free tier - spins down after 15 min inactivity
    region: oregon  # Should match backend region
    buildCommand: ""  # Docker handles building
    startCommand: ""  # Defined in Dockerfile
    envVars:
      - key: VITE_API_URL
        value: "https://nova-webgames-backend.onrender.com/api/v1"  # Update with your actual backend URL
    healthCheckPath: /health

# Database section removed - using existing snake-game-db
# Note: Render free tier only allows one database
# To create nova-webgames-db, first delete snake-game-db in Render dashboard
# Then uncomment the section below and re-apply the blueprint
#
# databases:
#   # PostgreSQL Database
#   - name: nova-webgames-db
#     plan: free  # Free tier - 1GB storage, expires after 30 days
#     databaseName: nova_webgames
#     user: nova_webgames_user

